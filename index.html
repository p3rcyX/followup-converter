<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Convert Follow Up</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600;700;800&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg0:#061a33;
      --bg1:#072a4a;
      --bg2:#0a3b6a;

      --glass: rgba(255,255,255,.08);
      --stroke: rgba(255,255,255,.14);
      --stroke2: rgba(125,211,252,.22);

      --ink: rgba(240,250,255,.92);
      --muted: rgba(240,250,255,.70);

      --accent:#1AA6FF;
      --accent2:#7DD3FC;

      --radius: 18px;
      --shadow: 0 26px 90px rgba(0,0,0,.45);
      --shadow2: 0 12px 40px rgba(0,0,0,.25);
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: Manrope, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color: var(--ink);
      padding: 28px 16px;
      background:
        radial-gradient(1200px 700px at 15% -10%, rgba(125,211,252,.28), transparent 58%),
        radial-gradient(900px 650px at 95% 0%, rgba(26,166,255,.26), transparent 55%),
        radial-gradient(1000px 800px at 55% 120%, rgba(56,189,248,.18), transparent 56%),
        linear-gradient(135deg, var(--bg0), var(--bg1) 45%, var(--bg2));
      overflow-x:hidden;
    }

    .wrap{ max-width: 1100px; margin: 0 auto; }

    .shell{
      position: relative;
      border-radius: 28px;
      background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06));
      border: 1px solid rgba(255,255,255,.12);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .shell:before{
      content:"";
      position:absolute;
      inset:-2px;
      background:
        radial-gradient(900px 260px at 12% 0%, rgba(125,211,252,.18), transparent 60%),
        radial-gradient(900px 280px at 92% 8%, rgba(26,166,255,.14), transparent 58%);
      pointer-events:none;
    }

    header{
      position: relative;
      padding: 22px 22px 16px;
      border-bottom: 1px solid rgba(255,255,255,.10);
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03));
    }

    .topRow{
      display:flex;
      gap: 14px;
      align-items:flex-end;
      justify-content:space-between;
      flex-wrap:wrap;
    }

    .title{
      margin:0;
      font-family: "Playfair Display", serif;
      font-weight: 700;
      letter-spacing: .3px;
      font-size: clamp(22px, 3.2vw, 36px);
      line-height: 1.1;
      text-shadow: 0 0 22px rgba(125,211,252,.12);
    }

    .sub{
      margin: 8px 0 0;
      color: var(--muted);
      font-size: 13.5px;
      line-height: 1.5;
      max-width: 900px;
    }

    .badge{
      white-space: nowrap;
      padding: 10px 12px;
      border-radius: 999px;
      background: linear-gradient(180deg, rgba(125,211,252,.16), rgba(255,255,255,.04));
      border: 1px solid rgba(125,211,252,.22);
      color: rgba(240,250,255,.9);
      font-weight: 800;
      font-size: 12px;
      letter-spacing: .6px;
      box-shadow: var(--shadow2);
    }

    .stack{
      position: relative;
      padding: 18px 22px 22px;
      display:flex;
      flex-direction: column;
      gap: 14px;
    }

    .card{
      position: relative;
      border-radius: var(--radius);
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.05));
      border: 1px solid rgba(255,255,255,.12);
      box-shadow: 0 18px 65px rgba(0,0,0,.30);
      overflow:hidden;
    }

    .cardHead{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
      padding: 14px 14px 10px;
    }

    .cardTitle{
      display:flex;
      align-items:center;
      gap: 10px;
      font-size: 12px;
      letter-spacing: .9px;
      text-transform: uppercase;
      color: rgba(240,250,255,.80);
      margin:0;
      font-weight: 800;
    }

    .dot{
      width: 10px; height: 10px; border-radius: 999px;
      background: radial-gradient(circle at 30% 30%, #fff, var(--accent2));
      box-shadow: 0 0 16px rgba(125,211,252,.50);
      flex: 0 0 auto;
    }

    .cardBody{ padding: 0 14px 14px; }

    textarea{
      width:100%;
      min-height: 220px;
      padding: 14px 14px;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(5, 12, 22, .25);
      color: rgba(240,250,255,.95);
      outline:none;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      font-size: 13px;
      line-height: 1.6;
      resize: vertical;
      transition: border-color .18s ease, box-shadow .18s ease;
    }
    textarea:focus{
      border-color: rgba(125,211,252,.35);
      box-shadow: 0 0 0 5px rgba(26,166,255,.10);
    }

    .actions{
      display:flex;
      flex-wrap:wrap;
      gap: 10px;
      margin-top: 12px;
    }

    button{
      appearance:none;
      border: 1px solid rgba(125,211,252,.20);
      background: linear-gradient(180deg, rgba(125,211,252,.16), rgba(255,255,255,.04));
      color: rgba(240,250,255,.92);
      font-weight: 900;
      letter-spacing: .6px;
      padding: 11px 14px;
      border-radius: 14px;
      cursor:pointer;
      box-shadow: 0 16px 55px rgba(0,0,0,.25);
      transition: transform .10s ease, border-color .14s ease;
      position: relative;
      overflow:hidden;
    }
    button:hover{ transform: translateY(-1px); border-color: rgba(125,211,252,.30); }
    button:active{ transform: translateY(0px); }

    .bolt{
      position:absolute;
      left: var(--x, 50%);
      top: -40%;
      width: 2px;
      height: 180%;
      opacity: 0;
      background: linear-gradient(180deg, transparent, rgba(255,255,255,.85), rgba(125,211,252,.55), transparent);
      filter: drop-shadow(0 0 10px rgba(125,211,252,.55));
      transform: translateX(-50%) rotate(10deg);
      pointer-events:none;
    }
    button.bolt-on .bolt{ animation: bolt .22s ease-out 1; }
    @keyframes bolt{
      0%{ opacity:0; transform: translateX(-50%) rotate(10deg) scaleY(.55); }
      20%{ opacity:1; }
      100%{ opacity:0; transform: translateX(-50%) rotate(10deg) scaleY(1.0); }
    }

    /* ====== TABLE ====== */
    .tableShell{
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.12);
      overflow:hidden;
      background: rgba(5, 12, 22, .22);
    }

    .tableTop{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      padding: 12px 12px;
      background: linear-gradient(180deg, rgba(125,211,252,.14), rgba(255,255,255,.03));
      border-bottom: 1px solid rgba(255,255,255,.10);
    }

    .meta{
      font-size: 12.5px;
      color: rgba(240,250,255,.82);
      line-height: 1.35;
    }
    .meta strong{ color: rgba(240,250,255,.95); }

    .count{
      padding: 7px 10px;
      border-radius: 999px;
      border: 1px solid rgba(125,211,252,.22);
      background: rgba(125,211,252,.10);
      font-size: 12px;
      font-weight: 900;
      letter-spacing:.4px;
      color: rgba(240,250,255,.90);
      white-space: nowrap;
    }

    .tableWrap{
      max-height: 440px;
      overflow:auto;
    }

    table{
      width:100%;
      border-collapse: separate;
      border-spacing: 0;
      font-size: 13px;
      color: rgba(240,250,255,.92);
    }

    thead th{
      position: sticky;
      top: 0;
      z-index: 2;
      text-align:left;
      padding: 12px 12px;
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: .9px;
      background: rgba(7, 26, 51, .92);
      border-bottom: 1px solid rgba(255,255,255,.10);
      backdrop-filter: blur(10px);
      white-space: nowrap;
    }

    tbody td{
      padding: 12px 12px;
      border-bottom: 1px solid rgba(255,255,255,.08);
      vertical-align: top;
    }

    tbody tr:nth-child(odd){ background: rgba(255,255,255,.03); }
    tbody tr:hover{ background: rgba(125,211,252,.06); }

    .mono{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      letter-spacing: .2px;
    }
    .right{ text-align:right; white-space: nowrap; }

    .status{
      display:inline-block;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(125,211,252,.18);
      background: rgba(125,211,252,.08);
      font-weight: 900;
      font-size: 12px;
      color: rgba(240,250,255,.88);
      white-space: nowrap;
    }

    /* raw output hidden (untuk copy) */
    #output{
      position:absolute;
      left:-9999px;
      top:-9999px;
      white-space: pre-wrap;
    }

    footer{
      padding: 0 22px 18px;
      text-align:center;
      color: rgba(240,250,255,.55);
      font-size: 12px;
    }

    .tableWrap::-webkit-scrollbar{ height: 10px; width: 10px; }
    .tableWrap::-webkit-scrollbar-thumb{
      background: rgba(255,255,255,.14);
      border-radius: 999px;
      border: 2px solid rgba(0,0,0,0);
      background-clip: padding-box;
    }
    .tableWrap::-webkit-scrollbar-track{ background: rgba(255,255,255,.04); }

    /* ====== MODERN TOAST POPUP ====== */
    .toastHost{
      position: fixed;
      right: 16px;
      top: 16px;
      z-index: 99999;
      display: grid;
      gap: 10px;
      width: min(420px, calc(100vw - 32px));
      pointer-events: none;
    }

    .toast{
      pointer-events: auto;
      display:flex;
      align-items:flex-start;
      gap: 12px;
      padding: 12px 12px;
      border-radius: 16px;
      background: rgba(6, 16, 30, .72);
      border: 1px solid rgba(255,255,255,.14);
      backdrop-filter: blur(12px);
      box-shadow: 0 18px 55px rgba(0,0,0,.38);
      transform: translateY(-6px);
      opacity: 0;
      animation: toastIn .18s ease-out forwards;
      position: relative;
      overflow:hidden;
    }

    .toast:before{
      content:"";
      position:absolute;
      inset:0;
      background: radial-gradient(420px 120px at 20% 0%, rgba(125,211,252,.12), transparent 60%);
      pointer-events:none;
    }

    @keyframes toastIn{
      to{ opacity: 1; transform: translateY(0); }
    }

    .tIcon{
      width: 36px; height: 36px;
      border-radius: 12px;
      display:grid;
      place-items:center;
      flex: 0 0 auto;
      border: 1px solid rgba(255,255,255,.12);
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.04);
    }

    .tMain{ flex: 1 1 auto; min-width: 0; }
    .tTitle{
      margin: 0;
      font-weight: 900;
      letter-spacing: .2px;
      font-size: 13px;
      color: rgba(240,250,255,.95);
    }
    .tMsg{
      margin: 4px 0 0;
      color: rgba(240,250,255,.72);
      font-size: 12.5px;
      line-height: 1.35;
      word-break: break-word;
    }

    .tClose{
      appearance:none;
      border: 0;
      background: transparent;
      color: rgba(240,250,255,.70);
      cursor: pointer;
      padding: 6px;
      border-radius: 10px;
      line-height: 0;
    }
    .tClose:hover{ background: rgba(255,255,255,.06); }

    .bar{
      position:absolute;
      left:0; bottom:0;
      height: 3px;
      width: 100%;
      background: rgba(125,211,252,.22);
      transform-origin: left;
      animation: barShrink linear forwards;
    }
    @keyframes barShrink{
      to{ transform: scaleX(0); }
    }

    /* Variants */
    .toast.success{ border-color: rgba(34,197,94,.22); }
    .toast.success .tIcon{ background: rgba(34,197,94,.14); }
    .toast.success .bar{ background: rgba(34,197,94,.35); }

    .toast.error{ border-color: rgba(239,68,68,.22); }
    .toast.error .tIcon{ background: rgba(239,68,68,.14); }
    .toast.error .bar{ background: rgba(239,68,68,.35); }

    .toast.info{ border-color: rgba(125,211,252,.22); }
    .toast.info .tIcon{ background: rgba(125,211,252,.14); }
    .toast.info .bar{ background: rgba(125,211,252,.35); }

    .toast.warn{ border-color: rgba(245,158,11,.22); }
    .toast.warn .tIcon{ background: rgba(245,158,11,.14); }
    .toast.warn .bar{ background: rgba(245,158,11,.35); }

    /* === CRITICAL ERROR (POPUP PALING UTAMA, MERAH BESAR) === */
    .toast.critical{
      position: fixed;
      left: 50%;
      top: 14px;
      transform: translate(-50%, 0);
      width: min(780px, calc(100vw - 32px));
      padding: 16px 16px;
      border-radius: 18px;
      background: linear-gradient(180deg, rgba(80,10,18,.92), rgba(18,6,10,.78));
      border: 1px solid rgba(239,68,68,.48);
      box-shadow: 0 30px 90px rgba(0,0,0,.55);
      z-index: 100000;
    }
    .toast.critical:before{
      background: radial-gradient(650px 170px at 25% 0%, rgba(239,68,68,.22), transparent 60%);
    }
    .toast.critical .tIcon{
      width: 42px; height: 42px;
      border-radius: 14px;
      background: rgba(239,68,68,.18);
      border-color: rgba(239,68,68,.42);
      font-weight: 900;
      font-size: 18px;
    }
    .toast.critical .tTitle{
      font-size: 14px;
      letter-spacing: .3px;
    }
    .toast.critical .tMsg{
      font-size: 13px;
      color: rgba(255,235,238,.88);
    }
    .toast.critical .bar{
      height: 4px;
      background: rgba(239,68,68,.55);
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="shell">
      <header>
        <div class="topRow">
          <div>
            <h1 class="title">HOKIJITU — Convert Follow UP</h1>
            <p class="sub">Ambil semua hasil catat dari docs lalu tempel di tabel, setelah itu Convert.</p>
          </div>
          <div class="badge">FOLLOW UP CONVERT</div>
        </div>
      </header>

      <div class="stack">
        <!-- INPUT (ATAS) -->
        <section class="card">
          <div class="cardHead">
            <h3 class="cardTitle"><span class="dot"></span>Input Follow Up Disini.</h3>
          </div>
          <div class="cardBody">
            <textarea id="input" placeholder="Paste data dari Docs / Google Sheets di sini
Jenis Bank / Nama Rekening / Nomor Rekening / Saldo Akhir / Keterangan"></textarea>
            <div class="actions">
              <button id="btnConvert" onclick="convertData()">
                CONVERT
                <span class="bolt" aria-hidden="true"></span>
              </button>
              <button id="btnCopy" onclick="copyOutput()">
                COPY ALL
                <span class="bolt" aria-hidden="true"></span>
              </button>
            </div>
          </div>
        </section>

        <!-- OUTPUT (BAWAH) -->
        <section class="card">
          <div class="cardHead">
            <h3 class="cardTitle"><span class="dot"></span>Hasil Convert Follow Up</h3>
          </div>
          <div class="cardBody">
            <div class="tableShell">
              <div class="tableTop">
                <div class="meta">
                  <strong>Info:</strong> HOKIJITU <br>
                  <strong>Perihal:</strong> Follow Up Rekening Bank Off / Bermasalah
                </div>
                <div class="count" id="rowCount">0 Data</div>
              </div>

              <div class="tableWrap">
                <table>
                  <thead>
                    <tr>
                      <th style="min-width:160px;">Jenis Bank</th>
                      <th style="min-width:240px;">Nama Rekening</th>
                      <th style="min-width:190px;">Nomor Rekening</th>
                      <th class="right" style="min-width:160px;">Saldo Akhir</th>
                      <th style="min-width:180px;">Keterangan</th>
                    </tr>
                  </thead>
                  <tbody id="prettyBody">
                    <tr>
                      <td colspan="5" style="padding:14px 12px; color:rgba(240,250,255,.65);">
                        Belum ada data. Klik <b>CONVERT</b> untuk menampilkan tabel.
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>

            <!-- RAW output: dipakai fungsi asli copyOutput() -->
            <div id="output"></div>
          </div>
        </section>
      </div>

      <footer>© HOKIJITU — Follow Up Rekening Bank Off / Bermasalah</footer>
    </div>
  </div>

  <!-- Toast host -->
  <div class="toastHost" id="toastHost" aria-live="polite" aria-atomic="true"></div>

  <script>
    // klik effect minimal (bukan lebay)
    function tinyBolt(btn, ev){
      const rect = btn.getBoundingClientRect();
      const x = ((ev?.clientX ?? (rect.left + rect.width/2)) - rect.left) / rect.width * 100;
      btn.style.setProperty('--x', x + '%');
      btn.classList.remove('bolt-on');
      void btn.offsetWidth;
      btn.classList.add('bolt-on');
      setTimeout(()=>btn.classList.remove('bolt-on'), 160);
    }
    document.getElementById('btnConvert').addEventListener('click', (e)=>tinyBolt(e.currentTarget, e));
    document.getElementById('btnCopy').addEventListener('click', (e)=>tinyBolt(e.currentTarget, e));

    // ====== MODERN POPUP (TOAST) ======
    const toastHost = document.getElementById('toastHost');

    function toastIcon(type){
      if(type === 'success') return '✓';
      if(type === 'critical') return '⛔';
      if(type === 'error') return '!';
      if(type === 'warn') return '⚠';
      return '⚠';
    }

    function toastTitle(type){
      if(type === 'success') return 'Berhasil';
      if(type === 'critical') return 'FORMAT DATA SALAH';
      if(type === 'error') return 'Gagal';
      if(type === 'warn') return 'PERHATIAN!';
      return 'INPUT MASIH KOSONG ASTAGA!';
    }

    function showToast(type, message, duration=2400){
      // CRITICAL: selalu paling utama (hapus toast lain dulu)
      if(type === 'critical'){
        toastHost.innerHTML = '';
      } else {
        // limit max toast
        while(toastHost.children.length >= 3) toastHost.removeChild(toastHost.lastChild);
      }

      const el = document.createElement('div');
      el.className = `toast ${type}`;
      el.innerHTML = `
        <div class="tIcon">${toastIcon(type)}</div>
        <div class="tMain">
          <p class="tTitle">${toastTitle(type)}</p>
          <p class="tMsg">${escapeHtml(message)}</p>
        </div>
        <button class="tClose" aria-label="Tutup">✕</button>
        <div class="bar" style="animation-duration:${duration}ms"></div>
      `;

      const closeBtn = el.querySelector('.tClose');
      const remove = () => {
        el.style.opacity = '0';
        el.style.transform = 'translateY(-6px)';
        setTimeout(()=> el.remove(), 140);
      };

      closeBtn.addEventListener('click', remove);
      toastHost.prepend(el);

      window.clearTimeout(el._t);
      el._t = window.setTimeout(remove, duration);
    }

    // Render tabel (tampilan saja)
    function escapeHtml(str){
      return String(str)
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }
    function normalizeSaldoForView(s){
      s = String(s ?? "").trim();
      if (s.startsWith("(") && s.endsWith(")")) return "-" + s.slice(1, -1);
      return s;
    }

    function renderPrettyTable(){
      const input = document.getElementById("input").value.trim();
      const body = document.getElementById("prettyBody");
      const rowCount = document.getElementById("rowCount");

      if(!input){
        body.innerHTML = `
          <tr>
            <td colspan="5" style="padding:14px 12px; color:rgba(240,250,255,.65);">
              Belum ada data. Klik <b>CONVERT</b> untuk menampilkan tabel.
            </td>
          </tr>`;
        rowCount.textContent = "0 Data";
        return;
      }

      const lines = input.split(/\r?\n/).filter(l => l.trim());
      const rows = [];

      lines.forEach(line => {
        const cols = line.split("\t");
        if (cols.length < 5) return;
        rows.push({
          bank: cols[0].trim(),
          norek: cols[1].trim(),
          nama: cols[2].trim(),
          saldo: normalizeSaldoForView(cols[3]),
          ket: cols[4].trim(),
        });
      });

      rowCount.textContent = rows.length + " Data";

      if(!rows.length){
        rowCount.textContent = "0 Data";
        body.innerHTML = `
          <tr>
            <td colspan="5" style="padding:14px 12px; color:rgba(240,250,255,.65);">
              Data tidak valid / kolom kurang. Pastikan 5 kolom (TAB).
            </td>
          </tr>`;

        // === POPUP PALING UTAMA (MERAH BESAR) ===
        showToast('critical', 'Data tidak valid / kolom kurang. Pastikan 5 kolom (TAB).', 4200);
        return;
      }

      body.innerHTML = rows.map(r => `
        <tr>
          <td class="mono">${escapeHtml(r.bank)}</td>
          <td>${escapeHtml(r.nama)}</td>
          <td class="mono">${escapeHtml(r.norek)}</td>
          <td class="right mono">Rp ${escapeHtml(r.saldo)}</td>
          <td><span class="status">${escapeHtml(r.ket)}</span></td>
        </tr>
      `).join("");
    }

    // setelah convertData() asli jalan, render tabel; popup info jika input kosong
    document.getElementById('btnConvert').addEventListener('click', () => {
      const inp = document.getElementById("input").value.trim();
      setTimeout(renderPrettyTable, 0);
      if(!inp) showToast('INPUT MASIH KOSONG ASTAGA!', 'Paste data docs dulu bos lalu klik CONVERT.');
    });

    // ====== KODE ASLI ANDA (TIDAK DIUBAH) ======
    function normalizeSaldo(saldo) {
      saldo = saldo.trim();
      // Jika pakai kurung → minus
      if (saldo.startsWith("(") && saldo.endsWith(")")) {
        saldo = "-" + saldo.slice(1, -1);
      }
      return saldo;
    }

    function convertData() {
      const input = document.getElementById("input").value.trim();
      const outputDiv = document.getElementById("output");

      if (!input) {
        outputDiv.textContent = "";
        return;
      }

      const lines = input.split(/\r?\n/);

      // HEADER INFO (muncul sekali)
      let result =
`Info : HOKIJITU
Perihal : Follow Up Rekening Bank Off / Bermasalah

`;

      lines.forEach(line => {
        if (!line.trim()) return;

        const cols = line.split("\t");
        if (cols.length < 5) return;

        const jenisBank = cols[0].trim();
        const nomorRekening = cols[1].trim();
        const nama = cols[2].trim();
        const saldo = normalizeSaldo(cols[3]);
        const keterangan = cols[4].trim();

        result +=
`Jenis Bank  : ${jenisBank}
Nama Rekening  : ${nama}
Nomor Rekening  : ${nomorRekening}
Saldo Ahkir   : Rp: ${saldo}
Keterangan : ${keterangan}
------------------------------
`;
      });

      outputDiv.textContent = result.trim();
    }

    function copyOutput() {
      const text = document.getElementById("output").textContent;

      // POPUP: tidak ada data untuk dicopy
      if (!text || !text.trim()) {
        showToast('warn', 'Tidak ada data untuk disalin. Klik CONVERT terlebih dahulu.');
        return;
      }

      navigator.clipboard.writeText(text).then(() => {
        // POPUP: berhasil
        showToast('success', 'Follow Up berhasil disalin.');
      }).catch(() => {
        // POPUP: error
        showToast('error', 'Gagal menyalin. Izinkan akses clipboard / coba browser lain.');
      });
    }
  </script>
</body>
</html>
